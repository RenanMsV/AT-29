<?xml version="1.0"?>

<system name="armament">

  <property value="0">systems/armament/release</property>
  <property value="0">systems/armament/guns/trigger</property>

  <channel name="guns50cal">

    <!-- .50cal trigger left -->
    <switch name="/controls/armament/trigger-gun-l">
      <default value="0"/>
      <test logic="AND" value="1">
        systems/armament/guns/trigger EQ 1
        /ai/submodels/submodel[0]/count GT 0
        /controls/switches/cockpit/gun-heat EQ 1
        /controls/switches/cockpit/gun-charge-l EQ 1
        /controls/switches/cockpit/master-arm EQ 1
      </test>
      <output>/controls/armament/trigger</output>
    </switch>

    <!-- .50cal trigger right -->
    <switch name="/controls/armament/trigger-gun-r">
      <default value="0"/>
      <test logic="AND" value="1">
        systems/armament/guns/trigger EQ 1
        /ai/submodels/submodel[1]/count GT 0
        /controls/switches/cockpit/gun-heat EQ 1
        /controls/switches/cockpit/gun-charge-r EQ 1
        /controls/switches/cockpit/master-arm EQ 1
      </test>
      <output>/controls/armament/trigger</output>
    </switch>

    <summer name="systems/armament/guns/ammo-summ">
      <input>/ai/submodels/submodel[0]/count</input>
      <input>/ai/submodels/submodel[1]/count</input>
      <clipto>
        <min>0</min>
        <max>500</max>
      </clipto>
    </summer>

  </channel>

  <channel name="Armament">

     <!-- release station 1 -->
     <switch name="systems/armament/station1/released">
          <default value="systems/armament/station1/released"/>
          <test logic="AND" value="1">
                systems/armament/release == 1
                systems/armament/station1/selected == 1
          </test>
          <output>systems/armament/station1/released</output>
     </switch>

     <!-- release station 2 -->
     <switch name="systems/armament/station2/released">
          <default value="systems/armament/station2/released"/>
          <test logic="AND" value="1">
                systems/armament/release == 1
                systems/armament/station2/selected == 1
          </test>
          <output>systems/armament/station2/released</output>
     </switch>

     <!-- release station 3 -->
     <switch name="systems/armament/station3/released">
          <default value="systems/armament/station3/released"/>
          <test logic="AND" value="1">
                systems/armament/release == 1
                systems/armament/station3/selected == 1
          </test>
          <output>systems/armament/station3/released</output>
     </switch>

  </channel>

  <channel name="Bombs">

   <!-- release bomb 1 -->
     <switch name="systems/armament/bomb1/released">
          <default value="0"/>
          <test value="1">
                systems/armament/station2/released == 1
          </test>
     </switch>


   <!-- release bomb 2 -->
     <switch name="systems/armament/bomb2/released">
          <default value="0"/>
          <test value="1">
                systems/armament/station2/released == 1
          </test>
     </switch>

  </channel>

  <channel name="Weight-loss">

     <!-- station 1 -->
     <switch name="systems/armament/station1/weight-control">
          <default value="inertia/pointmass-weight-lbs[0]"/>
          <test value="40">
                systems/armament/station1/released == 1
          </test>
          <output>inertia/pointmass-weight-lbs[0]</output>
     </switch>

     <!-- station 2 -->
     <switch name="systems/armament/station2/weight-control">
          <default value="inertia/pointmass-weight-lbs[1]"/>
          <test value="0">
                systems/armament/station2/released == 1
          </test>
          <output>inertia/pointmass-weight-lbs[1]</output>
     </switch>

     <!-- station 3 -->
     <switch name="systems/armament/station3/weight-control">
          <default value="inertia/pointmass-weight-lbs[2]"/>
          <test value="0">
                systems/armament/station3/released == 1
          </test>
          <output>inertia/pointmass-weight-lbs[2]</output>
     </switch>

     <!-- station 4 -->
     <switch name="systems/armament/station4/weight-control">
          <default value="inertia/pointmass-weight-lbs[3]"/>
          <test value="0">
                systems/armament/station2/released == 1
          </test>
          <output>inertia/pointmass-weight-lbs[3]</output>
     </switch>

     <!-- station 5 -->
     <switch name="systems/armament/station5/weight-control">
          <default value="inertia/pointmass-weight-lbs[4]"/>
          <test value="40">
                systems/armament/station1/released == 1
          </test>
          <output>inertia/pointmass-weight-lbs[4]</output>
     </switch>


  </channel>


  <channel name="Fuel-loss">

     <!-- station 2 -->
     <switch name="systems/armament/station2/fuel-level-control">
          <default value="propulsion/tank[1]/contents-lbs"/>
          <test value="0">
                systems/armament/station2/released == 1
          </test>
          <output>propulsion/tank[1]/contents-lbs</output>
     </switch>

     <!-- station 3 -->
     <switch name="systems/armament/station3/fuel-level-control">
          <default value="propulsion/tank[3]/contents-lbs"/>
          <test value="0">
                systems/armament/station3/released == 1
          </test>
          <output>propulsion/tank[3]/contents-lbs</output>
     </switch>

     <!-- station 4 -->
     <switch name="systems/armament/station4/fuel-level-control">
          <default value="propulsion/tank[2]/contents-lbs"/>
          <test value="0">
                systems/armament/station2/released == 1
          </test>
          <output>propulsion/tank[2]/contents-lbs</output>
     </switch>

  </channel>

</system>
